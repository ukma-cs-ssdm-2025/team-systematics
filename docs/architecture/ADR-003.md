# ADR-003: Клієнтська частина автентифікації та контролю доступу

**Статус:** Прийнято

**Дата:** 2025-09-29

## Контекст

Це рішення описує реалізацію клієнтської частини (frontend) для підтримки безпечної взаємодії з сервером, доповнюючи ADR-005. Воно базується на вимогах:
*   **Функціональні вимоги**, що чітко розмежовують можливості для різних ролей. Наприклад: **Студент** (FR-001, FR-004), **Викладач** (FR-005, FR-011) та **Наглядач** (FR-006, FR-009).
*   **SEC-003** вимагає, щоб клієнт надійно передавав автентифікаційні дані для перевірки на сервері.
*   **SEC-002** вимагає реалізації механізму автоматичного виходу з системи після 25 хвилин бездіяльності.

## Рішення

Клієнтський додаток буде реалізовано як односторінковий додаток (SPA), що централізовано керує сесією користувача та доступом до інтерфейсу.

1.  **Управління токеном:** Після успішного входу JWT-токен зберігається в localStorage для забезпечення стійкості сесії.

2.  **Централізована обробка помилок доступу:** Перехоплювач відповідей (response interceptor) буде глобально обробляти помилки доступу:
    *   При отриманні `401 Unauthorized` (недійсний або застарілий токен), додаток автоматично виконає вихід із системи та перенаправить користувача на сторінку входу.
    *   При отриманні `403 Forbidden` (недостатньо прав для дії), додаток перенаправить користувача на спеціальну сторінку «Доступ заборонено».

3.  **Захист маршрутів:** Захисники маршрутів (Route Guards) блокують доступ до сторінок на основі статусу входу та ролі користувача, перенаправляючи його за потреби.

4.  **Таймер бездіяльності:** Глобальний таймер відстежує активність користувача і автоматично завершує сесію через 25 хвилин.

## Наслідки

### Позитивні
* ✅ **Покращений досвід користувача (UX):** Користувач взаємодіє з чистим інтерфейсом, де відсутні недоступні йому елементи, що запобігає зайвим помилкам.
* ✅ **Централізована логіка:** Вся логіка, пов'язана з автентифікацією (збереження токена, захист маршрутів, обробка помилок), знаходиться в одному місці, що спрощує її підтримку.

### Негативні
*   ⚠️ **Збільшена складність фронтенд-додатку:** Реалізація глобального сховища стану та перехоплювачів вимагає більш складної архітектури.

## Альтернативи
* **Покладатися лише на помилки сервера:**
    *  **Відхилено:** призводить до поганого досвіду користувача, коли половина кнопок в інтерфейсі не працює.
* ** Зберігання токена в sessionStorage замість localStorage: **
    * **Відхилено:** при кожному перезавантаженні сторінки або закритті вкладки користувач змушений повторно входити в систему.
